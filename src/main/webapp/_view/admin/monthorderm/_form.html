#set(pageId=RandomUtil.random(6))
#set(iYear=DateUtil.getYear())
<div class="jbolt_page_title">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="col">
                        <button onclick="" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i> 数据导入</button>
                        <button onclick="submitThisForm()" class="btn btn-success btn-sm" onclick="submitThisForm()"><i class="fa fa-refresh"></i> 保存</button>
                        <button onclick="" class="btn btn-info btn-sm"><i class="fa fa-window-maximize"></i> 提交审批</button>
                        <button onclick="closeHandler()" class="btn btn-info btn-sm"><i class="fa fa-window-maximize"></i> 关闭</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <form onsubmit="return false;" id="MonthOrderM_Form_#(pageId)" action="#(action)" method="post">
                        #if(monthorderm.iAutoId??)
                        <input type="hidden" name="monthorderm.iAutoId" value="#(monthorderm.iAutoId??)"/>
                        #end
                        <input type="hidden" name="monthorderm.iOrderStatus" value="#(monthorderm.iOrderStatus??1)"/>
                        <input type="hidden" name="monthorderm.iAuditStatus" value="#(monthorderm.iAuditStatus??0)"/>
                        <input type="hidden" name="monthorderm.isDeleted" value="#(monthorderm.isDeleted??0)"/>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label">订单号</label>
                                    <div class="col-10">
                                        <input type="text" data-rule="required" data-notnull="true" data-tips="请输入订单号" data-with-clearbtn="true" autocomplete="off" class="form-control" placeholder="请输入订单号" maxlength="40" name="monthorderm.cOrderNo" value="#(monthorderm.cOrderNo??)"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group row">
                                	<input type="hidden" name="monthorderm.iCustomerId" value="#(monthorderm.iCustomerId??)" id="iCustomerId" data-value-attr="iautoid"/>
                                    <label class="col-sm-3 col-form-label">客户名称</label>
                                    <div class="col-9">
										<input type="text" class="form-control"
											   data-autocomplete
											   data-url="admin/customer/autocomplete"
											   data-rule="required"
											   data-hidden-input="iCustomerId"
											   data-text-attr="ccusname"
											   data-column-attr="ccuscode,ccusname,ccusabbname"
											   placeholder="请选择"
											   data-tips="请选择"
											   data-header="客户编码,客户名称,客户简称"
											   maxlength="40"
											   value="#(monthorderm.ccusname??)"
											   >                                        
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                            </div>
                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label">年份</label>
                                    <div class="col-10">
                                        <input data-done-handler="changeDoneYear"
                                               type="text"
                                               data-rule="required"
                                               data-date
                                               data-type="year"
                                               data-fmt="yyyy"
                                               autocomplete="off"
                                               class="form-control"
                                               maxlength="20"
                                               name="monthorderm.iYear"
                                               value="#datetime(monthorderm.iYear??DateUtil.getNow(),'yyyy')"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group row">
                            		<label class="col-sm-3 col-form-label">月份</label>
                                    <div class="col-9">
										<select class="form-control" data-autoload name="monthorderm.iMonth" 
											data-select="#datetime(monthorderm.iMonth??DateUtil.getNow(),'M')">
	                                        <option value="">=月份=</option>
	                                        <option value="1">1月</option>
	                                        <option value="2">2月</option>
	                                        <option value="3">3月</option>
	                                        <option value="4">4月</option>
	                                        <option value="5">5月</option>
	                                        <option value="6">6月</option>
	                                        <option value="7">7月</option>
	                                        <option value="8">8月</option>
	                                        <option value="9">9月</option>
	                                        <option value="10">10月</option>
	                                        <option value="11">11月</option>
	                                        <option value="12">12月</option>
	                                    </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="jbolt_page_content">
    <script type="text/template" id="jboltTable_demotpl_#(pageId)">
        {@each datas as data,index}
        <tr data-id="${data.iautoid}">
            <td>${pageNumber,pageSize,index | rownum}</td>
            <td>${data.cinvcode}</td>
            <td>${data.cinvcode1}</td>
            <td>${data.cinvname1}</td>
            <td>${data.cinvstd}</td>
            <td>${data.cuomname}</td>
            <td>${data.iqty1}</td>
			<td>${data.iqty2}</td>
			<td>${data.iqty3}</td>
			<td>${data.iqty4}</td>
			<td>${data.iqty5}</td>
			<td>${data.iqty6}</td>
			<td>${data.iqty7}</td>
			<td>${data.iqty8}</td>
			<td>${data.iqty9}</td>
			<td>${data.iqty10}</td>
			<td>${data.iqty11}</td>
			<td>${data.iqty12}</td>
			<td>${data.iqty13}</td>
			<td>${data.iqty14}</td>
			<td>${data.iqty15}</td>
			<td>${data.iqty16}</td>
			<td>${data.iqty17}</td>
			<td>${data.iqty18}</td>
			<td>${data.iqty19}</td>
			<td>${data.iqty20}</td>
			<td>${data.iqty21}</td>
			<td>${data.iqty22}</td>
			<td>${data.iqty23}</td>
			<td>${data.iqty24}</td>
			<td>${data.iqty25}</td>
			<td>${data.iqty26}</td>
			<td>${data.iqty27}</td>
			<td>${data.iqty28}</td>
			<td>${data.iqty29}</td>
			<td>${data.iqty30}</td>
			<td>${data.iqty31}</td>
			<td>${data.isum}</td>
			<td>
    			<a href="admin/person/deleteByAjax" data-ajaxbtn data-loading="执行中 " tooltip data-title="移除行" data-handler="removeTr" data-confirm="确定删除此数据？" class="jbolt_table_delbtn"><i class="fa fa-remove c-danger">移除行</i></a>
			</td>
        </tr>
        {@/each}
    </script>
    <div class="jbolt_table_toolbar" id="monthorderm_toolbar_#(pageId)">
        <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
            <button onclick="jboltTableAppendEmptyRow(this)" class="btn btn-primary btn-sm">添加行</button>
        </div>
    </div>
    <table class="jbolt_table thead_font_normal table-bordered table-center"
           data-jbolttable
           #if(monthorderm.iAutoId??)
           data-ajax="true"
           data-url="admin/monthorderd/findEditTableDatas?imonthordermid=#(monthorderm.iAutoId??)"
           #end
           id="jbolt_Table_#(pageId)"
           data-column-resize="true"
           data-tfoot-fixed="true"
           data-column-prepend="1:checkbox"
           data-rowtpl="jboltTable_demotpl_#(pageId)"
           data-toolbar="monthorderm_toolbar_#(pageId)"
           data-editable="true"
           data-editable-option="getEditableTableOptions_#(pageId)"
    >
        <thead class="fw_normal">
        <tr>
            <th data-width="60" data-column="index">序号</th>
            <th data-width="150" data-column="cinvcode">存货编码</th>
            <th data-width="150" data-column="cinvcode1">客户部番</th>
            <th data-width="150" data-column="cinvname1">部品名称</th>
            <th data-width="150" data-column="cinvstd">规格</th>
            <th data-width="100" data-column="cuomname">库存主单位</th>
            <th data-column="iqty1">1日</th>
            <th data-column="iqty2">2日</th>
            <th data-column="iqty3">3日</th>
            <th data-column="iqty4">4日</th>
            <th data-column="iqty5">5日</th>
            <th data-column="iqty6">6日</th>
            <th data-column="iqty7">7日</th>
            <th data-column="iqty8">8日</th>
            <th data-column="iqty9">9日</th>
            <th data-column="iqty10">10日</th>
            <th data-column="iqty11">11日</th>
            <th data-column="iqty12">12日</th>
        	<th data-column="iqty13">13日</th>
       		<th data-column="iqty14">14日</th>
       		<th data-column="iqty15">15日</th>
       		<th data-column="iqty16">16日</th>
       		<th data-column="iqty17">17日</th>
       		<th data-column="iqty18">18日</th>
       		<th data-column="iqty19">19日</th>
       		<th data-column="iqty20">20日</th>
       		<th data-column="iqty21">21日</th>
       		<th data-column="iqty22">22日</th>
       		<th data-column="iqty23">23日</th>
       		<th data-column="iqty24">24日</th>
       		<th data-column="iqty25">25日</th>
       		<th data-column="iqty26">26日</th>
       		<th data-column="iqty27">27日</th>
       		<th data-column="iqty28">28日</th>
       		<th data-column="iqty29">29日</th>
       		<th data-column="iqty30">30日</th>
        	<th data-column="iqty31">31日</th>
        	<th data-column="isum">合计</th>
            <th data-width="100">操作</th>
        </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
        <tr>
            <th></th>
            <th>合计</th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>			
            <th></th>
            <th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
            <th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
            <th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
        <tr>
        </tfoot>
    </table>
</div>
#define js()
<script>
hideParentLayerDialogBtn(0);
hideParentLayerDialogBtn(1);
function submitThisForm(){
	jboltTableSubmit("#jbolt_Table_#(pageId)");
}
    //获得配置参数
    function getEditableTableOptions_#(pageId)() {
        var editableTableOptions = {
            submit: {
                withForm: ["MonthOrderM_Form_#(pageId)"],
                name: 'monthOrderMForm',
                type: "all",
                url: "/admin/monthorderm/submitAll",
                success: function (res) {
                    LayerMsgBox.success("提交成功", 600, function () {
                        parent.refreshPjaxContainer();
                        parent.layer.closeAll();
                    });
                }
            },
            cols: {
            	iautoid: {
                    submitAttr: "iautoid",
                },
                cinvcode: {
                    type: "autocomplete",
                    url: "admin/inventory/autocomplete",
                    maxLength: 100,
                    required: true,
                    placeholder: "请选择",
                    textAttr: "cinvcode",
                    width: 500,
                    valueAttr: "cinvcode",
                    columnAttr: "cinvcode,cinvcode1,cinvname1,cinvstd,cuomname",
                    header:'存货编码,客户部番,部品名称,规格,库存主单位',
                    changeColumns:[{column: "cinvcode", use: "cinvcode"},{column: "cinvcode1", use: "cinvcode1"},
                                   {column: "cinvname1", use: "cinvname1"},{column: "cinvstd", use: "cinvstd"},
                                   {column: "cuomname", use: "cuomname"},{column: "iinventoryid", use: "iautoid"}]
                },
                iqty1: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty2: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty3: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty4: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty5: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty6: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty7: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty8: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty9: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty10: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty11: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty12: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty13: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty14: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty15: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty16: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty17: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty18: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty19: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty20: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty21: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty22: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty23: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty24: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty25: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty26: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty27: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty28: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty29: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty30: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				iqty31: {
					type:"amount",
					placeholder:'数量',
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				},
				isum: {
					summary:[{
						dir:"h",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"iqty1+iqty2+iqty3+iqty4+iqty5+iqty6+iqty7+iqty8+iqty9+iqty10+iqty11+iqty12+iqty13+iqty14+iqty15+iqty16+iqty17+iqty18+iqty19+iqty20+iqty21+iqty22+iqty23+iqty24+iqty25+iqty26+iqty27+iqty28+iqty29+iqty30+iqty31"
					}],
					summary:[{
						dir:"v",
						tofixed:2,
						roundtag:"round",
						removezero:true,
						formula:"sum"
					}]
				}
            }
        };
        return editableTableOptions;
    }

    function closeHandler(){
    	parent.layer.close(parent.layer.getFrameIndex(window.name));
        window.parent.refreshJBoltTable();
    }
</script>
#end

