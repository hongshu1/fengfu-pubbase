#@jboltLayout()
#define main()
#set(pageId=RandomUtil.random(6))
<div class="jbolt_page" style="height: 100vh;" data-key="#(pmkey)" data-dontchangeleftnav="true">
<div class="jbolt_page_title">
	<div class="row">
		<div class="col-md-auto text-left">
			<form class="form-inline" id="chooseInvestmentPlanForm_#(pageId)"  onsubmit="return false;" method="post">
				<input type="text" class="form-control"
                           data-date
                           data-type="year"
                           placeholder="=预算年度="
                           name="ibudgetyear">
                <select class="form-control"
                		data-select-type="select2"
                        name="cdepcode"
                        data-autoload
                        data-tips="u8部门"
                        data-url="admin/department/getTreeTableDatas?isProposal=true"
                        data-text="=u8部门="
                        data-text-attr="cdepname"
                        data-value-attr="cdepcode"
                        data-setvalueto="cdepcode"
                        data-value=""
                        data-width="200">
                </select>
                <select class="form-control"
                    		data-select-type="select2"
                            name="ibudgettype"
                            data-autoload
                            data-tips="预算类型"
                            data-url="admin/dictionary/options?key=investment_budget_type"
                            data-text="=预算类型="
                            data-text-attr="name"
                            data-value-attr="sn"
                            data-value=""
                            data-width="200">
                </select>
                <input type="text" autocomplete="off" class="form-control col-md-1" placeholder="=投资NO=" name="cplanno" value=""/>
                <input type="text" autocomplete="off" class="form-control col-md-1" placeholder="=项目名称=" name="citemname" value=""/>
				<button  type="submit" class="btn btn-outline-secondary" ><i class="fa fa-search"></i> 查询</button>
				<button type="reset" class="btn btn-outline-secondary"><i class="jbicon jb-11zhongzhi"></i> 重置</button>
			</form>
		</div>
	</div>
</div>
	<div class="jbolt_page_title">
    	<div class="row">
			<div class="col-md-auto">
				<h1><i class="fa fa-file-text-o"></i>投资计划项目</h1>
			</div>
		</div>
	</div>
    <div class="jbolt_page_content">
        <!-- JBoltTable的数据模板定义-->
        <script type="text/template" id="jboltTable_investmentPlanEditForm_#(pageId)">
            {@each datas as data,index}
            <tr data-id="${data.iautoid}">
			<td>${data.cdepname}</td>
			<td>${data.ibudgetyear}</td>
			<td>${data.cbudgettypedesc}</td>
			<td>${data.cinvestmenttypedesc}</td>
            <td>${data.cproductline}</td>
            <td>${data.cmodelinvccode}</td>
            <td>${data.cparts}</td>
            <td>${data.careertypedesc}</td>
            <td>${data.cinvestmentdistinctiondesc}</td>
			<td>${data.cplanno}</td>
			<td>${data.citemname}</td>
            <td>$${data.isimport|isLargeAmountExpense}</td>
            <td>${data.iquantity}</td>
            <td>${data.cunit}</td>
			<td>${data.cassettypedesc}</td>
			<td>${data.cpurpose}</td>
			<td>${data.ceffectamount}</td>
			<td>${data.creclaimyear}</td>
			<td>${data.clevel}</td>
			<td>$${data.ispriorreport|isLargeAmountExpense}</td>
			<td>${data.cpaymentprogressdesc}</td>
			<td>${data.itaxrate|removeNumberEndZero}</td>
			<td>${data.cedittypedesc}</td>
			<td>${data.iitemyear}</td>
			<td>${data.cmemo}</td>
			<td>${data.cperiodprogressdesc1}</td>
			<td>${data.dperioddate1|date_ym}</td>
			<td>${data.iamount1}</td>
			<td>${data.cperiodprogressdesc2}</td>
			<td>${data.dperioddate2|date_ym}</td>
			<td>${data.iamount2}</td>
			<td>${data.cperiodprogressdesc3}</td>
			<td>${data.dperioddate3|date_ym}</td>
			<td>${data.iamount3}</td>
			<td>${data.cperiodprogressdesc4}</td>
			<td>${data.dperioddate4|date_ym}</td>
			<td>${data.iamount4}</td>
			<td>${data.cperiodprogressdesc5}</td>
			<td>${data.dperioddate5|date_ym}</td>
			<td>${data.iamount5}</td>
			<td>${data.cperiodprogressdesc6}</td>
			<td>${data.dperioddate6|date_ym}</td>
			<td>${data.iamount6}</td>
            </tr>
            {@/each}
        </script>

        <table class="jbolt_table jbolt_main_table thead_font_normal table-center"
               data-jbolttable
               id="jbolt_Table_#(pageId)"
               data-ajax="true"
               data-url="/admin/investmentplanmonthadjustmentm/findUnfinishInvestmentPlanItemDatas"
               data-column-resize="true"
               data-bind-elements="#jbolt_righttop_btn_group_#(pageId)>button"
               data-rowtpl="jboltTable_investmentPlanEditForm_#(pageId)"
               data-column-prepend="1:checkbox:true"
               data-height="fill"
               data-conditions-form="chooseInvestmentPlanForm_#(pageId)"
        >
            <thead class="fw_normal">
            <tr>
	            <th data-width="100" data-column="cdepname" rowspan="2">部门</th>
	            <th data-width="100" data-column="ibudgetyear" rowspan="2">预算年份</th>
	            <th data-width="100" data-column="ibudgettype" rowspan="2">预算类型</th>
	            <th data-width="100" data-column="iinvestmenttype" rowspan="2">投资类型</th>
	            <th data-width="90" data-column="cproductline" rowspan="2">生产线</th>
	            <th data-width="100" data-column="cmodelinvccode" rowspan="2">机种</th>
	            <th data-width="100" data-column="cparts" rowspan="2">部品</th>
	            <th data-width="130" data-column="icareertype" rowspan="2">事业区分</th>
	            <th data-width="130" data-column="iinvestmentdistinction" rowspan="2">投资区分</th>
	            <th data-width="130" data-column="cplanno" rowspan="2">投资NO.</th>
	            <th data-width="130" data-column="citemname" rowspan="2">名称</th>
	            <th data-width="100" data-column="isimport" rowspan="2">是否进口</th>
	            <th data-width="25" data-column="iquantity" rowspan="2">数量</th>
	            <th data-width="25" data-column="cunit" rowspan="2">单位</th>
	            <th data-width="50" data-column="cassettype" rowspan="2">资产类别</th>
	            <th data-width="50" data-column="cpurpose" rowspan="2">目的</th>
	            <th data-width="50" data-column="ceffectamount" rowspan="2">效果金额</th>
	            <th data-width="50" data-column="creclaimyear" rowspan="2">回收年限</th>
	            <th data-width="50" data-column="clevel" rowspan="2">等级区分</th>
	            <th data-width="50" data-column="ispriorreport" rowspan="2">是否需要做事情报告</th>
	            <th data-width="50" data-column="cpaymentprogress" rowspan="2">实施阶段</th>
	            <th data-width="50" data-column="itaxrate" rowspan="2">税率(%)</th>
	            <th data-width="50" data-column="cedittype" rowspan="2">修订区分</th>
	            <th data-width="50" data-column="iitemyear" rowspan="2">立项年份</th>
	            <th data-width="50" data-column="cmemo" rowspan="2">备注</th>
	            <th colspan="3">第一期</th>
	            <th colspan="3">第二期</th>
	            <th colspan="3">第三期</th>
	            <th colspan="3">第四期</th>
	            <th colspan="3">第五期</th>
	            <th colspan="3">第六期</th>
            </tr>
            <tr>
            	<th data-width="50" data-column="cperiodprogress1">日程</th>
            	<th data-width="50" data-column="dperioddate1">日期</th>
            	<th data-width="50" data-column="iamount1">金额</th>
            	<th data-width="50" data-column="cperiodprogress2">日程</th>
            	<th data-width="50" data-column="dperioddate2">日期</th>
            	<th data-width="50" data-column="iamount2">金额</th>
            	<th data-width="50" data-column="cperiodprogress3">日程</th>
            	<th data-width="50" data-column="dperioddate3">日期</th>
            	<th data-width="50" data-column="iamount3">金额</th>
            	<th data-width="50" data-column="cperiodprogress4">日程</th>
            	<th data-width="50" data-column="dperioddate4">日期</th>
            	<th data-width="50" data-column="iamount4">金额</th>
            	<th data-width="50" data-column="cperiodprogress5">日程</th>
            	<th data-width="50" data-column="dperioddate5">日期</th>
            	<th data-width="50" data-column="iamount5">金额</th>
            	<th data-width="50" data-column="cperiodprogress6">日程</th>
            	<th data-width="50" data-column="dperioddate6">日期</th>
            	<th data-width="50" data-column="iamount6">金额</th>
            </tr>
            </thead>
            <tbody id="datatr1"></tbody>
        </table>
    </div>

</div>
#end
#define js()
<script>
    function submitThisForm(){
        var unfinishItemCheckedTableDatas = getJboltTableCheckedDatas("#jbolt_Table_#(pageId)");
        parent.insertUnfinishInvestmentPlanItem(unfinishItemCheckedTableDatas);
        // 关闭当前页面
        parent.layer.close(parent.layer.getFrameIndex(window.name));
    }
</script>

#end

