#@jboltLayout()

#define css()
<style>
	.card-body overflow-auto{
		max-width: 40%;
		border: 1px solid #ff0000;
		white-space: nowrap;
		text-overflow:ellipsis;
		overflow: hidden;
	}
</style>
#end

#define main()
#set(pageId=RandomUtil.random(6))
<div class="jbolt_page_content">
	#setLocal(jboltTabId=(goods.id?? RandomUtil.random(6)))
	<nav>
		<div class="nav nav-tabs" id="nav-tab_#(jboltTabId)" role="tablist">
			<a class="nav-item nav-link active" id="nav-base-tab_one_1" data-toggle="tab" href="#tab-one_1" role="tab" onclick="refreshPjaxContainer()" aria-controls="tab-one" aria-selected="true">物料清单</a>
			<a class="nav-item nav-link" id="nav-base-tab_two_1" data-toggle="tab" href="#tab-two_1" role="tab" onclick="refreshJBoltTable()" aria-controls="tab-two" aria-selected="false">版本记录</a>
		</div>
	</nav>
	<div class="tab-content" style="padding: 0px 1rem">
		<!--1 物料清单 -->
		<div class="tab-pane fade show active" id="tab-one_1" role="tabpanel" aria-labelledby="nav-base-tab_one_1">
			#render("bommaster_index.html")
		</div>
		<!--2 版本记录 -->
		<div class="tab-pane fade" id="tab-two_1" role="tabpanel" aria-labelledby="nav-base-tab_two_1">
			#ajaxPortal("/admin/bommaster/versionIndex","bommaster_jstree",true)
		</div>
	</div>
</div>
#end

#define js()
<script type="text/javascript">

	initTreehandler('');

	function bommaster_jstree(tree, data){
		// data.data == id 后台控制的
		var isChildren = true;
		if (data.children.length > 0){
			isChildren = false;
		}
		$("#addEmptyBtn_#(pageId)").data("url","admin/bomcompare/manualForm?pid="+data.data+"&isChildren="+isChildren);
		AjaxPortalUtil.go("bomcompareAjaxPortal1", "/admin/bomcompare/index?id="+data.data+"&isChildren="+isChildren);
	}

	function initTreehandler(item) {
		var treeHtmlStr ="<div " +
				"					data-jstree" +
				"                     data-open-level='-1'" +
				"					  data-curd='false' " +
				"                     data-async='true'" +
				"                     data-search-input='searchBackGoodsTypeInput_2'" +
				"                     data-change-handler='bommaster_jstree'" +
				"                     data-conditions-form='bomMaster_1_'" +
				"                     data-read-url='admin/bomM/getTreeDatas?item='+item>";
		$("#bommasterBackCategoryTree").html(treeHtmlStr);
		JSTreeUtil.init($("#bommasterBackCategoryTree"));
	}

	function keyWordsOnChange() {
		var item = $("#searchBackGoodsTypeInput_2").val()
		initTreehandler(item);
	}

</script>
#end
