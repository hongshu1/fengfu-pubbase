#@jboltLayout()
#define main()
#set(pageId=RandomUtil.random(6))
<div class="jbolt_page_content">
	<div class="row">
		<div class="col-auto mb-3" style="width:30%;">
			<div class="card">
				<div class="card-header py-2">
						<span class="d-inline-block py-1">母件物料清单
							<!-- <button  onclick="tPageFn()"  class="btn btn-outline-primary btn-sm" ><i class="fa fa-refresh"></i>同步U9</button>-->
						</span>
					<div class="pull-right">
						<form id="bomMaster_1_#(pageId)">
							<input type="hidden" name="enableIcon"
								   value="
								  <a tooltip='' data-title='查看' data-dialogbtn='' data-area='90%,90%' href='admin/bommaster/info/?'> <i class='fa fa-eye c-info' style='position: absolute;left: 380px;'></i></a>
								  <a tooltip='' data-title='编辑' data-dialogbtn='' data-area='90%,90%' href='admin/bommaster/edit/?' ><i class='fa fa-edit c-primary' style='position: absolute;left: 410px;'></i></a>
								  <a tooltip='' data-title='复制版本提示' data-dialogbtn='' data-area='400,300' href='admin/bommaster/copyForm/?' ><i class='fa fa-copy c-warning' style='position: absolute;left: 435px;'></i></a>
								  <a tooltip='' data-ajaxbtn href='admin/bommaster/ajaxSuccess' data-confirm='确定要执行此操作？'><i class='fa fa-trash c-danger'  style='position: absolute;left: 460px;'></i></a>
">
						</form>
						<input type="text" class="form-control"  id="searchBackGoodsTypeInput_#(pageId)"
						//onblur="onblurInput()"
							   placeholder="输入关键字过滤" />
					</div>
				</div>
				<div class="card-body overflow-auto" style="width:600px;height: 80%">
					<div data-jstree
						 data-open-level="-1"
						 data-async="true"
						 data-change-handler="bommaster_jstree_#(pageId)"
						 data-conditions-form="bomMaster_1_#(pageId)"
						 data-read-url="admin/bommaster/getDatas">
					</div>
				</div>

			</div>
		</div>
		<div class="col-auto" style="width:70%;">
			#ajaxPortal("/admin/bomcompare/index","customerBackCategoryPortal_#(pageId)",true)
		</div>
	</div>
</div>
#end

#define js()
<script type="text/javascript">
	function bommaster_jstree_#(pageId)(data){
		// get_all_checked第一个参数 full-默认false 只返回ID true是返回整条数据json
		// get_all_checked第二个参数 withoutRoot 默认false 就是都出来 如果是true 就不带root节点 有些root节点无用
		// console.log(tree.jstree(true).get_all_checked(true,false))
		// LayerMsgBox.alert("选择了："+data.text);

		var allChecked = tree.jstree(true).get_all_checked(true, false);
		console.log(allChecked);

		var checkedArr = [];

		$.each(allChecked, function (idx, row) {
			checkedArr.push(row.id);
		});

		var checkedIds = checkedArr.join(',');

		$('input[name="checkedIds"]').val(checkedIds);

		setTimeout(function () {

			// 清空参数
			$('input[name="renderEmpty"]').val('');
			// 刷新已授权菜单
			JSTreeUtil.refresh($tree3);

		}, 100);

	}
</script>
#end
