<div class="jbolt_page_title">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="col">
                        <button class="btn btn-success btn-sm" onclick="submitThisForm()" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end><i
                                class="fa fa-refresh" ></i> 保存
                        </button>
                        #if(sysotherin.AutoID??)
                        ### 参数列表
                        ### uri:                接口URI
                        ### formSn:             表单名
                        ### o:                  当前表单对象名
                        ### primaryKeyName:     主键名
                        #include("/_view/_common/_approval_btns.html", uri="/admin/otherInList", formSn="T_Sys_OtherIn", o=sysotherin, edit=edit??, primaryKeyName="AutoID")
                        #end
                        <button onclick="closeHandler()" class="btn btn-info btn-sm"><i
                                class="fa fa-window-maximize"></i> 关闭
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <form onsubmit="return false;" id="sysotherin_#(pageId)" action="#(action)" method="post">
                        #if(sysotherin.AutoID??)
                        <input type="hidden" name="sysotherin.AutoID" value="#(sysotherin.AutoID??)"/>
                        #end
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">入库单号</label>
                                    <div class="col-9">
                                        <input type="text" data-notnull="true"
                                               data-tips="请输入入库单号" data-with-clearbtn="true" autocomplete="off" disabled
                                               class="form-control" placeholder="请输入入库单号" maxlength="40"
                                               name="sysotherin.BillNo" value="#(sysotherin.BillNo??)"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">入库日期</label>
                                    <div class="col-9">
                                        <input type="text" data-date class="form-control ml-2" placeholder="入库日期" disabled
                                               maxlength="20" name="sysotherin.dcreatetime"
                                               value="#(sysotherin.dcreatetime??)"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <input type="hidden" name="sysotherin.Whcode" value="#(sysotherin.Whcode??)"
                                           id="cwhcode" data-value-attr="cwhcode"/>
                                    <label class="col-sm-3 col-form-label">仓库名称</label>
                                    <div class="col-9">
                                        <input type="text" class="form-control" data-autocomplete
                                               data-url="admin/productInList/getWarehouse" data-rule="required"
                                               data-hidden-input="cwhcode" data-text-attr="cwhname"
                                               data-column-attr="cwhcode,cwhname" placeholder="请选择仓库名称"
                                               data-tips="请选择仓库名称" data-header="仓库编码,仓库名称" maxlength="40"
                                               value="#(cwhname??)" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <input type="hidden" name="sysotherin.RdCode" value="#(sysotherin.RdCode??)"
                                           id="crdcode" data-value-attr="crdcode"/>
                                    <label class="col-sm-3 col-form-label">入库类别</label>
                                    <div class="col-9">
                                        <input type="text" class="form-control" data-autocomplete
                                               data-url="admin/productInList/getRdStyle" data-rule="required"
                                               data-hidden-input="crdcode" data-text-attr="crdname"
                                               data-column-attr="crdcode,crdname" placeholder="请选择入库类别"
                                               data-tips="请选择入库类别" data-header="入库编码,入库类别" maxlength="40"
                                               value="#(crdname??)" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">业务类型</label>
                                    <div class="col-9">
                                        <select class="form-control" name="SourceBillType"
                                                data-autoload
                                                data-url="admin/dictionary/options?key=null"
                                                data-select-type="select"
                                                data-text="=业务类型="
                                                data-value=""
                                                data-value-attr="sn"
                                        ></select>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">业务号</label>
                                    <div class="col-9">
                                        <input type="text" data-notnull="true"
                                               data-tips="请输入业务号" data-with-clearbtn="true" autocomplete="off"
                                               class="form-control" placeholder="请输入业务号" maxlength="40"
                                               name="yw" value="#(sysotherin.BillNo??)"#if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <input type="hidden" name="sysotherin.VenCode" value="#(sysotherin.VenCode??)"
                                           id="vencode" data-value-attr="vencode"/>
                                    <label class="col-sm-3 col-form-label">供应商名称</label>
                                    <div class="col-9">
                                        <input type="text" class="form-control" data-autocomplete
                                               data-url="admin/materialReceiptList/venCode" data-rule="required"
                                               data-hidden-input="vencode" data-text-attr="venname"
                                               data-column-attr="vencode,venname" placeholder="请选择供应商名称"
                                               data-tips="请选择供应商名称" data-header="供应商编码,供应商名称"
                                               maxlength="40"
                                               value="#(venname??)" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">审批日期</label>
                                    <div class="col-9">
                                        <input type="text" data-date class="form-control ml-2" placeholder="审批日期" disabled
                                               maxlength="20" name="sysotherin.dAuditTime"
                                               value="#(sysotherin.daudittime??)"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">备注</label>
                                    <div class="col-9">
                                        <input type="text" data-notnull="true"
                                               data-tips="请输入备注" data-with-clearbtn="true" autocomplete="off"
                                               class="form-control" placeholder="请输入备注" maxlength="40"
                                               name="sysotherin.memo" value="#(sysotherin.memo??)" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">制单人</label>
                                    <div class="col-9">
                                        <input type="text" data-notnull="true"
                                               data-tips="请输制单人" data-with-clearbtn="true" autocomplete="off" disabled
                                               class="form-control" placeholder="请输制单人" maxlength="40"
                                               name="sysotherin.ccreatename" value="#(sysotherin.ccreatename??)"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">审核人</label>
                                    <div class="col-9">
                                        <input type="text" data-notnull="true"
                                               data-tips="请输审核人" data-with-clearbtn="true" autocomplete="off" disabled
                                               class="form-control" placeholder="请输审核人" maxlength="40"
                                               name="sysotherin.cauditname" value="#(sysotherin.cauditname??)"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

### 新增之后，并且为审核流
#if(sysotherin.AutoID?? && sysotherin.iauditway == 2)
#include("/_view/admin/approvalm/form_approval_flow.html", formAutoId=sysotherin.AutoID, formSn="T_Sys_OtherIn", btnNeed=1, pId=pageId,primaryKeyName="AutoID", className="cn.rjtech.admin.sysotherin.SysOtherinService")
#end

<div class="jbolt_page_content">
    <script type="text/template" id="sysotherin_tpl_#(pageId)">
        {@each datas as data,index}
        <tr data-id="${data.autoid}">
            <td>${pageNumber,pageSize,index | rownum}</td>
            <td>
                <a href="admin/sysotherindetail/delete/${data.autoid}" data-ajaxbtn data-loading="执行中 "
                   tooltip data-title="删除" data-handler="refreshJBoltTable" data-confirm="确定删除此数据？"
                   class="jbolt_table_delbtn"><i class="fa fa-remove c-danger">删除</i></a>

            </td>
            <td #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) data-editable="false" #end >${data.barcode}</td>
            <td>${data.cinvcode}</td>
            <td>${data.cinvdddcode}</td>
            <td>${data.cinvname}</td>
            <td>${data.cinvstd}</td>
            <td>${data.inventorycuomname}</td>
            <td>${data.qty}</td>
            <td>${data.pat}</td>
            <td>${data.cinvccode}</td>
            <td>${data.cinvcname}</td>
        </tr>
        {@/each}
    </script>
    <div class="jbolt_table_toolbar" id="sysotherin_toolbar_#(pageId)">
        <div class="col-md-4">
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">现品票扫码</label>
                <div class="col-5">
                    <input type="text" data-notnull="true" data-tips="请输入现品票扫码" data-with-clearbtn="true"
                           autocomplete="off" class="form-control" placeholder="请输入现品票扫码" maxlength="40" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end
                           id="barcode" name="barcode" value="#(barcode??)"/>
                </div>
                <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
                    <button onclick="barcode()" class="btn btn-primary btn-sm" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end >搜索</button>
                </div>
                <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
                    <button onclick="jboltTableAppendEmptyRow(this)" class="btn btn-primary btn-sm" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end >添加行</button>
                </div>
                <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
                    <button onclick="jboltTableRemoveCheckedRow(this, true, false)" data-confirm="确定删除选中数据？" class="btn btn-danger btn-xs" #if(sysotherin.iAuditStatus?? ==2 || sysotherin.iAuditStatus?? ==3 || sysotherin.iAuditStatus?? ==1) disabled #end   ><i class="fa fa-trash"></i> 删除行</button>
                </div>
            </div>
        </div>

    </div>

    <table class="jbolt_table thead_font_normal table-bordered table-center" data-jbolttable #if(sysotherin.AutoID??)
           data-ajax="true" data-url="admin/sysotherindetail/findEditTableDatas?masid=#(sysotherin.AutoID??)" #end
           id="jbolt_Table_#(pageId)" data-column-resize="true" data-tfoot-fixed="true" data-column-prepend="1:checkbox"
           data-rowtpl="sysotherin_tpl_#(pageId)" data-toolbar="sysotherin_toolbar_#(pageId)" data-editable="true"
           data-page="sysotherin_tpl_#(pageId)" data-editable-option="getJBoltTableEditableColsOpton">
        <thead class="fw_normal">
        <tr>
            <th data-width="60">序号</th>
            <th data-width="150">操作</th>
            <th data-width="100" data-column="barcode">现品票</th>
            <th data-width="100" data-column="cinvcode">存货编码</th>
            <th data-width="100" data-column="cinvdddcode">存货代码</th>
            <th data-width="100" data-column="cinvname">存货名称</th>
            <th data-width="100" data-column="cinvstd">规格型号</th>
            <th data-width="100" data-column="inventorycuomname">主计量单位</th>
            <th data-width="100" data-column="qty">数量</th>
            <th data-width="100" data-column="pat">批号</th>
            <th data-width="100" data-column="cinvccode">项目大类编码</th>
            <th data-width="100" data-column="cinvcname">项目大类名称</th>
        </tr>
        </thead>
    </table>

</div>
#define js()
<script>
    hideParentLayerDialogBtn(0);
    hideParentLayerDialogBtn(1);

    function submitThisForm() {
        jboltTableSubmit("#jbolt_Table_#(pageId)");
        return true;
    }

    function getJBoltTableEditableColsOpton() {
        var editableTableOptions = {
            submit: {
                withForm: ["sysotherin_#(pageId)"],
                name: 'sysotherin',
                type: "all",
                url: "/admin/otherInList/submitAll",
                success: function (res) {
                    LayerMsgBox.success("提交成功", 600, function () {
                        parent.refreshPjaxContainer();
                        parent.layer.closeAll();
                    });
                }
            },
            cols: {
                AutoID: {
                    submitAttr: "AutoID",
                },
                barcode: { //条码
                    maxLength: 100,
                    required: true,
                    placeholder: "=请选择=",
                    type: "autocomplete",
                    url: "admin/otherout/barcodeDatas",
                    textAttr: "barcode",
                    width: 800,
                    sync: "",
                    valueAttr: "barcode",
                    columnAttr: "barcode,cinvcode,cinvdddcode,cinvname,cinvstd,inventorycuomname,qty,cequipmentmodelname",
                    header: '现品票,存货编码,存货代码,存货名称,规格型号,主计量单位,数量,所属机型',
                    changeColumns: [{column: "barcode", use: "barcode"}, {
                        column: "cinvcode",
                        use: "cinvcode"
                    }, {column: "cinvcode1", use: "cinvcode1"},
                        {column: "cinvname1", use: "cinvname1"}, {column: "cinvstd", use: "cinvstd"},
                        {column: "cinvccode", use: "cinvccode"}, {column: "cinvcname", use: "cinvcname"},
                        {column: "cuomclassname", use: "cuomclassname"}, {
                            column: "iinventoryid",
                            use: "iautoid"
                        }, {column: "sourcebilltype", use: "sourcebilltype"},
                        {column: "sourcebillno", use: "sourcebillno"}, {column: "sourcebilldid", use: "sourcebilldid"},
                        {column: "sourcebillnorow", use: "sourcebillnorow"}, {
                            column: "sourcebillid",
                            use: "sourcebillid"
                        }, {column: "cinvdddcode", use: "cinvdddcode"},
                        {column: "cinvname", use: "cinvname"}, {column: "inventorycuomname", use: "inventorycuomname"},
                        {column: "sourcebillid", use: "sourcebillid"}, {column: "qty", use: "qty"}, {
                            column: "pat",
                            use: "pat"
                        }]

                },
            }
        };
        return editableTableOptions;
    }

    function closeHandler() {
        parent.layer.close(parent.layer.getFrameIndex(window.name));
        window.parent.refreshJBoltTable();
    }

</script>
#end