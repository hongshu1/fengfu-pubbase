#define css()
<link rel="stylesheet" type="text/css" href="../../../assets/plugins/spreadJS/16.0.2/gc.spread.sheets.excel2013white.16.0.2.css">
#end

<div class="jbolt_page" data-key="#(pmkey)">
    <!-- <div class="jbolt_page_title">
         <div class="row">
             <div class="col-auto">
                 <form class="form-inline" id="jboltVersionForm_#(pageId)" onsubmit="return false;" method="post">
                     <input type="hidden" class="form-control" id="layYear" name="layYear"/>
                     <input type="hidden" class="form-control" id="customerName" name="customerName"/>
                     <input type="text" autocomplete="off" class="form-control" placeholder="输入客户名称" name="keywords" value=""/>
                     <input type="text" autocomplete="off" class="form-control" placeholder="输入存货编码" name="keywords" value=""/>
                     <input type="text" autocomplete="off" class="form-control" placeholder="输入客户部番" name="keywords" value=""/>
                     <input type="text" autocomplete="off" class="form-control" placeholder="输入部品名称" name="keywords" value=""/>
                     <input type="text" autocomplete="off" class="form-control" placeholder="输入机型" name="keywords" value=""/>
                     <button type="submit" class="btn btn-outline-secondary"><i class="fa fa-search"></i> 查询</button>
                     <button type="reset" class="btn btn-secondary"><i class="fa fa-recycle"></i> 重置</button>
                 </form>
             </div>
         </div>
     </div>-->
    <div class="jbolt_page_content">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <button class="btn btn-secondary" data-dialogbtn data-link-para-ele="#layYear,#customerName" data-area="600,400" data-title="作成条件"
                                data-url="/admin/yearproductionschedule/chooseData"><i class="fa fa-plus"></i> 作成条件
                        </button>
                        <input type="hidden" class="form-control" id="layYear" name="layYear"/>
                        <input type="hidden" class="form-control" id="customerName" name="customerName"/>

                        <button id="loadExcel" value="loadExcel" class="btn btn-secondary"><i class="fa fa-plus-square-o"></i> 数据导入</button>

                        <button id="exportExcel" class="btn btn-secondary"><i class="fa fa-trash"></i> 数据导出</button>

                        <button onclick="saveData()" class="btn btn-secondary"><i class="fa fa-refresh"></i> 保存</button>
                        <button onclick="getData()" class="btn btn-primary"><i class="fa fa-refresh"></i> 获取数据</button>

                        <!-- <button onclick="jboltTableMaximize(this)" class="btn btn-info"><i class="fa fa-window-maximize"></i> 提交审批</button>-->

                        <!-- <button onclick="refreshexcel()" class="btn btn-primary"><i class="fa fa-refresh"></i> 刷新</button>

                         <button onclick="getData()" class="btn btn-primary"><i class="fa fa-refresh"></i> 获取数据</button>
 -->
                        <!--<button onclick="exports()" class="btn btn-danger"><i class="fa fa-trash"></i> 数据导出</button>

                        <input type="file" id="fileInput" style="display:none;" />
                        <button id="importBtn" value="loadExcel" class="btn btn-success"><i class="fa fa-plus-square-o"></i> 数据导入</button>-->


                    </div>
                </div>
            </div>

        </div>
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div id="ss" style="width: 100%;height: 700px;"></div>
                        <div id="statusBar" style="height:25px;min-height:25px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

#define js()
<script src="../../../assets/plugins/Grape/FileSaver.min.js"></script>
<script src="../../../assets/plugins/scripts/myTool.js" type="text/javascript"></script>
<script src="../../../assets/plugins/Grape/16.0.2/js/gc.spread.sheets.all.16.0.2.min.js" type="text/javascript"></script>
<script src="../../../assets/plugins/Grape/16.0.2/js/gc.spread.excelio.16.0.2.min.js" type="text/javascript"></script>
<script src="../../../assets/plugins/Grape/16.0.2/js/gc.spread.sheets.tables.16.0.2.min.js" type="text/javascript"></script>
<script src="../../../assets/plugins/Grape/16.0.2/js/gc.spread.sheets.resources.zh.16.0.2.min.js" type="text/javascript"></script>
<script src="_view/admin/yearproductionschedule/spread.js?version=1.0.5" type="text/javascript"></script>
<script>
    /**
     * 定义dialog里选择的数据传递的方法和具体操作的组件
     */
    function setChooseDialogSelectResult(layYear, customerName) {
        $("#layYear").val(layYear);
        $("#customerName").val(customerName);

        LayerMsgBox.loading("BOM生成中...", 20000);
        inits();
        LayerMsgBox.closeLoading();
        LayerMsgBox.success("BOM生成成功", 3000);
    }
</script>
#end
