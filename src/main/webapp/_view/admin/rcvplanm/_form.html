<div class="jbolt_page_title">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="col">
                        <button onclick="" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i> 数据导入</button>
                        <button onclick="submitThisForm()" class="btn btn-success btn-sm" onclick="submitThisForm()"><i class="fa fa-refresh"></i> 保存</button>
                        <button onclick="" class="btn btn-info btn-sm"><i class="fa fa-window-maximize"></i> 提交审批
                        </button>
                        <button onclick="closeHandler()" class="btn btn-info btn-sm"><i
                                class="fa fa-window-maximize"></i> 关闭
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <form onsubmit="return false;" id="rcvplanm_#(pageId)" action="#(action)" method="post">
                        #if(rcvplanm.iAutoId??)
                        <input type="hidden" name="rcvplanm.iAutoId" value="#(rcvplanm.iAutoId??)"/>
                        #end
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group row">
                                    <label class="col-sm-3 col-form-label">取货计划单号</label>
                                    <div class="col-9">
                                        <input type="text" data-rule="required" data-notnull="true"
                                               data-tips="请输入取货计划单号" data-with-clearbtn="true" autocomplete="off"
                                               class="form-control" placeholder="请输入订单号" maxlength="40"
                                               name="rcvplanm.cRcvPlanNo" value="#(rcvplanm.cRcvPlanNo??)"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group row">
                                    <input type="hidden" name="rcvplanm.iCustomerId"
                                           value="#(rcvplanm.iCustomerId??)" id="iCustomerId"
                                           data-value-attr="iautoid"/>
                                    <label class="col-sm-3 col-form-label">客户名称</label>
                                    <div class="col-9">
                                        <input type="text" class="form-control"
                                               data-autocomplete
                                               data-url="admin/customer/autocomplete"
                                               data-rule="required"
                                               data-hidden-input="iCustomerId"
                                               data-text-attr="ccusname"
                                               data-column-attr="ccuscode,ccusname,ccusabbname"
                                               placeholder="请选择客户名称"
                                               data-tips="请选择客户名称"
                                               data-header="客户编码,客户名称,客户简称"
                                               maxlength="40"
                                               value="#(rcvplanm.ccusname??)"
                                        >
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="jbolt_page_content">
    <script type="text/template" id="rcvplanm_tpl_#(pageId)">
        {@each datas as data,index}
        <tr data-id="${data.iautoid}">
            <td>${pageNumber,pageSize,index | rownum}</td>
            <td>
                <a href="admin/rcvpland/delete/${data.iautoid}" data-ajaxbtn data-loading="执行中 " 
                tooltip data-title="删除" data-handler="refreshJBoltTable" data-confirm="确定删除此数据？" 
                class="jbolt_table_delbtn"><i class="fa fa-remove c-danger">删除</i></a>
   
            </td>
            <td>${data.ccarno}</td>
            <td>${data.cplancode}</td>
            <td>${data.crcvdate}</td>
            <td>${data.crcvtime}</td>
            <td>${data.cbarcode}</td>
            <td>${data.cversion}</td>
            <td>${data.caddress}</td>
            <td>${data.iinventoryid}</td>
            <td>${data.iinventoryid}</td>
            <td>${data.iinventoryid}</td>
            <td>${data.iqty}</td>


        </tr>
        {@/each}
    </script>
    <div class="jbolt_table_toolbar" id="rcvplanm_toolbar_#(pageId)">
        <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
            <button onclick="jboltTableAppendEmptyRow(this)" class="btn btn-primary btn-sm">添加行</button>
        </div>
        <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
            <button data-ajaxbtn data-handler="refreshJBoltTable" data-check-handler="jboltTableGetCheckedIds" 
            id="toolbar_deleteBtn_#(pageId)" data-url="admin/rcvpland/deleteByIds?ids=" 
            data-confirm="确定删除选中数据？" class="btn btn-outline-danger" ><i class="fa fa-trash"></i> 批量删除</button>
        </div>

    </div>

    <table class="jbolt_table thead_font_normal table-bordered table-center"
           data-jbolttable
           #if(rcvplanm.iAutoId??)
           data-ajax="true"
           data-url="admin/rcvpland/findEditTableDatas?rcvplanmid=#(rcvplanm.iAutoId??)"
           #end
           id="jbolt_Table_#(pageId)"
           data-column-resize="true"
           data-tfoot-fixed="true"
           data-column-prepend="1:checkbox"
           data-rowtpl="rcvplanm_tpl_#(pageId)"
           data-toolbar="rcvplanm_toolbar_#(pageId)"
           data-editable="true"
           data-editable-cols="getJBoltTableEditableColsOpton"
           data-page="rcvplanm_tpl_#(pageId)"
           data-editable-option="getJBoltTableEditableColsOpton"
    >
        <thead class="fw_normal">
        <tr>
            <th data-width="60" >序号</th>
            <th data-width="150" >操作</th>
            <th data-width="100" data-column="ccarno">取货车次号</th>
            <th data-width="100" data-column="cplancode">计划代码</th>
            <th data-width="100" data-column="crcvdate">取货日期</th>
            <th data-width="100" data-column="crcvtime">取货时间</th>
            <th data-width="100" data-column="cbarcode">传票号</th>
            <th data-width="100" data-column="cversion">传票版本号</th>
            <th data-width="100" data-column="caddress">收货地点</th>
            <th data-width="100" data-column="iinventoryid">存货编码</th>
            <th data-width="100" data-column="cinvcode1">客户部番</th>
            <th data-width="100" data-column="cinvname1">部品名称</th>
            <th data-width="100" data-column="iqty">计划数量</th>
        </tr>
        </thead>
        <tfoot>
            <th ></th>
            <th >合计</th>
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>     
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>
            <th ></th>
        </tfoot>
    </table>

</div>
#define js()
<script>
    hideParentLayerDialogBtn(0);
    hideParentLayerDialogBtn(1);
function submitThisForm(){
	jboltTableSubmit("#jbolt_Table_#(pageId)");
}    

function getJBoltTableEditableColsOpton(){

    return {
        submit: {
                withForm: ["rcvplanm_#(pageId)"],
                name: 'rcvplanm',
                type: "all",
                url: "/admin/pickupPlanManage/submitAll",
                success: function (res) {
                    LayerMsgBox.success("提交成功", 600, function () {
                        parent.refreshPjaxContainer();
                        parent.layer.closeAll();
                    });
                }
            },
        ccarno:{
            type:"input",//类型
            //maxLength:10,  //输入长度
            placeholder:"取货车次号", //输入提示，里面
            tooltip:"取货车次号",//输入提示，上方
            //rule:"pint", //校验规则
            //min:1,//最小值
            //max:4,//最大值
            required:true,//必填
            //cssClass:"bg-danger text-white",//样式
            //cssStyle:"font-size:20px",//字体大小
        },
        iinventoryid:{
            // type:"select",
            // url:admin/inventory/autocomplete,//url地址
            //valueAttr:"",//显示的字段，可以设置多个
            //onlyleaf:true,//树形结构只能选择叶子节点
            //required:true,//必填
            // changeColumns:[{column: "iinventoryid",//显示绑定的字段
            //                 use: "cinvcode"        //数据源的字段
            //                 }
            // ]   
            type: "autocomplete",
                    url: "admin/inventory/autocomplete",
                    maxLength: 100,
                    required: true,
                    placeholder: "请选择",
                    textAttr: "cinvcode",
                    width: 500,
                    valueAttr: "cinvcode",//选择赋值的字段
                    columnAttr: "cinvcode,cinvcode1,cinvname1,cinvstd,cuomname",//下来看的时候显示哪些字段
                    header:'存货编码,客户部番,部品名称,规格,库存主单位',
                    changeColumns:[{column: "cinvcode", use: "cinvcode"},{column: "cinvcode1", use: "cinvcode1"},
                                   {column: "cinvname1", use: "cinvname1"},{column: "cinvstd", use: "cinvstd"},
                                   {column: "cuomname", use: "cuomname"},{column: "iinventoryid", use: "iautoid"}]
        },
        iqty:{
            type:"amount",//类型
            //maxLength:10,  //输入长度
            placeholder:"数量", //输入提示，里面
            tooltip:"数量",//输入提示，上方
            //rule:"pint", //校验规则
            min:0,//最小值
            //max:4,//最大值
            required:true,//必填
            //cssClass:"bg-danger text-white",//样式
            //cssStyle:"font-size:20px",//字体大小
            summary:[{
						dir:"v",// v 纵向 ，h 横向
						tofixed:2,//保留两位小数
						roundtag:"round",//四舍五入
						removezero:true,//去0
						formula:"sum"   //求和公式
					}]
        },
    };
}
   


</script>
#end