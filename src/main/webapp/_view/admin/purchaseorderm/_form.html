<form onsubmit="return false;" id="PurchaseOrderM_Form" action="#(action)" method="post">
    #if(purchaseOrderM.iAutoId??)
    <input type="hidden" name="iAutoId" value="#(purchaseOrderM.iAutoId??)"/>
    <input type="hidden" name="dBeginDate" value="#(purchaseOrderM.dBeginDate??)"/>
    <input type="hidden" name="dEndDate" value="#(purchaseOrderM.dEndDate??)"/>
    #end
    <div class="row">

        <div class="col">
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">业务类型</label>
                <div class="col-6">
                    <select class="form-control" name="iBusType"
                            data-autoload
                            data-rule="required"
                            data-url="admin/dictionary/options?key=purchase_business_type"
                            data-select-type="select"
                            data-text="==请选择=="
                            data-value=""
                            data-value-attr="sn">
                    </select>
                </div>

            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">采购类型</label>
                <div class="col-6">
                    <select class="form-control" name="iPurchaseTypeId"
                            data-autoload
                            data-rule="required"
                            data-url="admin/purchaseorderm/findPurchaseType"
                            data-select-type="select"
                            data-text="==请选择=="
                            data-value=""
                            data-text-attr="cptname">
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">业务员</label>
                <div class="col-6">
                    <input type="hidden" id="ipersonid_#(pageId)" name="workregionm.ipersonid" value="#(workregionm.ipersonid??)" />
                    <input type="text" autocomplete="off" value="#(personname??)" class="form-control"
                           placeholder="==请选择人员=="
                           data-rule="required"
                           data-jboltinput
                           data-width="600"
                           data-height="450"
                           data-refresh="true"
                           data-hidden-input="ipersonid_#(pageId)"
                           data-load-type="ajaxportal"
                           data-url="admin/workregionm/personTable"
                    />
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">币种</label>
                <div class="col-6">
                    <select class="form-control" name="cCurrency"
                            data-autoload
                            data-rule="required"
                            data-url="admin/purchaseorderm/findForeignCurrencyAll"
                            data-select-type="select"
                            data-text="==请选择=="
                            data-value=""
                            data-text-attr="cexch_name">
                    </select>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">订单日期</label>
                <div class="col-6">
                    <input type="text" readonly data-rule="required" data-notnull="true" autocomplete="off" class="form-control" maxlength="20" name="purchaseOrderM.dOrderDate"
                           value="#datetime(purchaseOrderM.dOrderDate??,'yyyy-MM-dd')"/>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">供应商名称</label>
                <div class="col-6">
                    <input hidden type="text" name="iVendorId" value="#(purchaseOrderM.iVendorId??)">
                    <input type="text" autocomplete="off" class="form-control" value="#(purchaseOrderM.cVenName??)">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">税率</label>
                <div class="col-6">
                    <input type="text" data-with-clearbtn="true" autocomplete="off" class="form-control"
                           placeholder="请输入税率" maxlength="40" name="iTaxRate"
                           value="#(purchaseOrderM.iTaxRate??)"/>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">汇率</label>
                <div class="col-6">
                    <input type="text" data-with-clearbtn="true" autocomplete="off" class="form-control" data-rule="required"
                           placeholder="请输入汇率" maxlength="40" name="iExchangeRate"
                           value="#(purchaseOrderM.iExchangeRate??)"/>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">订单编号</label>
                <div class="col-6">
                    <input type="text" data-rule="required" data-notnull="true" data-tips="请输入订单编号" autocomplete="off" class="form-control"
                           placeholder="请输入订单编号" maxlength="40" name="cOrderNo"  readonly="readonly" value="#(purchaseOrderM.cOrderNo??)"/>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">部门</label>
                <div class="col-6">
                    <select class="form-control"
                            data-autoload
                            name="iDepartmentId"
                            data-tips="请选择部门"
                            data-rule="required"
                            data-url="admin/department/getTreeTableDatas"
                            data-text="=请选择部门="
                            data-value=""
                            data-value-attr="iautoid"
                            data-text-attr="cdepname"
                            data-select="#(workregionm.idepid??)">
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">应付类型</label>
                <div class="col-6">
                    <select class="form-control" name="iPayableType "
                            data-autoload
                            data-rule="required"
                            data-url="admin/dictionary/options?key=purchase_coping_type"
                            data-select-type="select"
                            data-text="==请选择=="
                            data-value=""
                            data-value-attr="sn">
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">备注</label>
                <div class="col-6">
                    <textarea class="form-control" style="height:80px"  placeholder="请输入备注" data-tips="请输入备注"  maxlength="200" name="cMemo">#(purchaseOrderM.cMemo??)</textarea>
                </div>
            </div>
        </div>
    </div>
    </div>
</form>
<!-- 定义JBoltTable使用的数据渲染模板 -->

<div class="jbolt_table_toolbar" id="PurchaseOrderD_toolbar_#(pageId)">
    <div class="btn-group btn-group-sm" role="group" aria-label="btn-group">
        <button data-ajaxbtn data-handler="refreshJBoltTable" data-check-handler="jboltTableGetCheckedIds"
                id="toolbar_deleteBtn_#(pageId)" data-url="admin/purchaseorderd/deleteByIds?ids="
                data-confirm="确定删除选中数据？" class="btn btn-outline-danger"><i class="fa fa-trash"></i> 删除
        </button>
    </div>

</div>
<table class="jbolt_table jbolt_main_table  table-center "
       data-jbolttable
       data-width="fill"
       data-height="fill"
       data-copy-to-excel="false"
       data-toolbar="PurchaseOrderD_toolbar_#(pageId)"
       data-column-prepend="1:checkbox:true:false:false"
       data-page="PurchaseOrderPage_#(pageId)"
>
    <thead>
    <tr>
        <th data-width="60"  rowspan="2" data-column="index">序号</th>
        <th data-width="80"  rowspan="2">操作</th>
        <th data-width="100" rowspan="2" data-column="iInventoryId">存货编码</th>
        <th data-width="150" rowspan="2" data-column="cInvCode1">客户部番</th>
        <th data-width="150" rowspan="2" data-column="cInvName1">部品名称</th>
        <th data-width="150" rowspan="2" data-column="cInvStd">规格</th>
        <th data-width="150" rowspan="2" data-column="iPurchaseUomId">采购单位</th>
        <th data-width="150" rowspan="2" data-column="iPkgQty">包装数量</th>
        <th data-width="100" rowspan="2" data-column="isPresent">是否赠品</th>
        <th data-width="100" rowspan="2" data-column="cMemo">备注</th>
        <th data-width="100" rowspan="2" data-column="iVendorAddrId">供应商地址</th>
        <!--   显示日期 -->
        #for(key:tableHeadMap.keySet())
            <th data-width="80" colspan="#(tableHeadMap.get(key).size())">#(key)</th>
        #end
    </tr>

    <tr>
        #for(data:tableHeadMap.keySet())
            #for(day: tableHeadMap.get(data))
              <th data-width="80" data-column="#(day)">#(day)</th>
            #end
        #end
        <th data-width="80">合计</th>
    </tr>
    </thead>
    <tbody>
        #for(data:tableData)
            <tr>
                <td>#(for.index+1)</td>
                <td>操作</td>
                <td>#(data.cinvcode??)</td>
                <td>#(data.cinvcode1??)</td>
                <td>#(data.cinvname1??)</td>
                <td>#(data.cinvstd??)</td>
                <td>#(data.cinvcode??)</td>
                <td></td>
                <td> #boolToStr(data.isgavepresent?? == 1,"是","否")</td>
                <td>
                    <input type="text" data-with-clearbtn="true" autocomplete="off" class="form-control"
                           maxlength="200"/>
                </td>
                <td>#(data.cdistrictname??)</td>
                #for(qty:data.arr??)
                 <td>#(qty)</td>
                #end
                <td>#(data.isum??)</td>
            </tr>
        #end
    </tbody>
</table>
#define js()
<script>
    $(function(){
        //初始化page
        initPage("PurchaseOrderPage_#(pageId)",#(pageData.totalPage??),#(pageData.pageNumber??),"PurchaseOrderM_Form");
    });
</script>
#include("/_view/_admin/common/_formjs.html",formId="PurchaseOrderM_Form")
#include("/_view/_admin/common/_jbolt_table_page.html",pageEleId="PurchaseOrderM_Table_"+pageId)
#end

