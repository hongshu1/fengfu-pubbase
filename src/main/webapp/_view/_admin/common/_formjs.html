<script>
needPjax=false;
var _submit_ing=false;
function submitThisForm#(randomFunctionName??)(successCallback){
	if(_submit_ing){
		return false;
	}
	_submit_ing=true;
	var formId="#(formId)";
	var form=$("#"+formId);
	if(FormChecker.check(form)){
		if(window.beforeFormSubmit#(randomFunctionName??)){
			var ret=beforeFormSubmit#(randomFunctionName??)();
			if(ret==false){
				_submit_ing=false;
				return false;
			}
		}
		var url = actionUrl(form.attr("action"));
		LayerMsgBox.loading("正在提交...",10000);
		form.ajaxSubmit({
			type:"post",
			url:url,
			success:function(ret){
				if(ret.state=="ok"){
					if(window.afterFormSubmit#(randomFunctionName??)){
						afterFormSubmit#(randomFunctionName??)(ret,function(){
							LayerMsgBox.success(ret.msg,500,function(){
								_submit_ing=false;
								if(successCallback){
									successCallback();
								}
							});
						});
					}else{
						LayerMsgBox.success(ret.msg,500,function(){
							_submit_ing=false;
							if(successCallback){
								successCallback();
							}
						});
					}
					
				}else{
					_submit_ing=false;
					if(ret.msg){
						if(ret.msg=="jbolt_system_locked"){
							showJboltLockSystem();
							return false;
						}else if(ret.msg=="jbolt_nologin"){
							showReloginDialog();
							return false;
						}
					}
					if(window.afterFormSubmit#(randomFunctionName??)){
						afterFormSubmit#(randomFunctionName??)(ret,function(){
							if(ret.msg){
								LayerMsgBox.alert(ret.msg,2);
							}else{
								LayerMsgBox.error("操作异常",1500);
							}
						});
					}else{
						if(ret.msg){
							LayerMsgBox.alert(ret.msg,2);
						}else{
							LayerMsgBox.error("操作异常",1500);
						}
					}
					
				}
			},
			error:function(){
				LayerMsgBox.error("发生异常",1500,function(){
					_submit_ing=false;
					});
				}
		});
	}else{
		_submit_ing=false;
		}
}
</script>