(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(a){a.extend(a.summernote.plugins,{emoji:function(c){var o=this;var g=27;var n=9;var k=a.summernote.ui;var m={};var d={};var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var q=Math.random()*16|0,p=s=="x"?q:(q&3|8);return p.toString(16)});var l=function(r,s){var q=[];for(var p=0;p<r.length;p+=s){q.push(r.slice(p,p+s))}return q};if(!Array.prototype.filter){Array.prototype.filter=function(q){var p=this.length>>>0;if(typeof q!="function"){throw new TypeError()}var t=[];var s=arguments[1];for(var r=0;r<p;r++){if(r in this){var u=this[r];if(q.call(s,u,r,this)){t.push(u)}}}return t}}var b=function(){var p=a("body");p.on("keydown",function(q){if(q.keyCode===g||q.keyCode===n){o.$panel.hide()}});p.on("mouseup",function(r){r=r.originalEvent||r;var q=r.target||window;if(a(q).hasClass("emoji-picker")||a(q).hasClass("emoji-menu-tab")){return}o.$panel.hide()});p.on("click","."+e+" .emoji-menu-tab",function(s){s.stopPropagation();s.preventDefault();var r=0;var q=a(this).attr("class").split(" ");q=q[1].split("-");if(q.length===3){return}q=q[0]+"-"+q[1];a("."+e+" .emoji-menu-tabs td").each(function(u){var v=a(this).find("a");var t=v.attr("class").split(" ");t=t[1].split("-");t=t[0]+"-"+t[1];if(q===t){v.attr("class","emoji-menu-tab "+t+"-selected");r=u}else{v.attr("class","emoji-menu-tab "+t)}});h(r)});a(document).on("click","."+e+" .emoji-items a",function(){var r=a(".label",a(this)).text();if(document.emojiType==="unicode"){c.invoke("editor.insertText",j(r))}else{var q=a(i(o.icons[r]));if(q[0].attachEvent){q[0].attachEvent("onresizestart",function(s){s.returnValue=false},false)}c.invoke("editor.insertNode",q[0])}ConfigStorage.get("emojis_recent",function(s){s=s||Config.defaultRecentEmojis||[];var t=s.indexOf(r);if(!t){return false}if(t!==-1){s.splice(t,1)}s.unshift(r);if(s.length>42){s=s.slice(42)}ConfigStorage.set({emojis_recent:s})})})};var f=function(){var t,p,s,v,x,u,q,r,y,w;v=void 0;u=void 0;s=void 0;x={};r={};q=void 0;p=void 0;y=void 0;t=void 0;w=void 0;u=0;while(u<Config.EmojiCategories.length){w=Config.EmojiCategorySpritesheetDimens[u][1];v=0;while(v<Config.EmojiCategories[u].length){p=Config.Emoji[Config.EmojiCategories[u][v]];q=p[1][0];y=Math.floor(v/w);t=v%w;x[":"+q+":"]=[u,y,t,":"+q+":"];r[q]=p[0];v++}u++}o.icons=x;o.reverseIcons=r;if(!Config.rx_codes){Config.init_unified()}};var h=function(p){var q=a("."+e+" .emoji-items");q.html("");if(p>0){a.each(o.icons,function(r,s){if(o.icons.hasOwnProperty(r)&&s[0]===(p-1)){q.append('<a href="javascript:void(0)" title="'+Config.htmlEntities(r)+'">'+i(s,true)+'<span class="label">'+Config.htmlEntities(r)+"</span></a>")}})}else{ConfigStorage.get("emojis_recent",function(r){r=r||Config.defaultRecentEmojis||[];var t,s;for(s=0;s<r.length;s++){t=r[s];if(o.icons[t]){q.append('<a href="javascript:void(0)" title="'+Config.htmlEntities(t)+'">'+i(o.icons[t],true)+'<span class="label">'+Config.htmlEntities(t)+"</span></a>")}}})}};var i=function(w){var t=w[0];var B=w[1];var u=w[2];var s=w[3];var q=document.emojiSource+"/emoji_spritesheet_!.png";var A=document.emojiSource+"/blank.gif";var z=25;var y=-(z*u);var p=-(z*B);var v=(Config.EmojiCategorySpritesheetDimens[t][1]*z);var x=(Config.EmojiCategorySpritesheetDimens[t][0]*z);var r="display:inline-block;";r+="width:"+z+"px;";r+="height:"+z+"px;";r+="background:url('"+q.replace("!",t)+"') "+y+"px "+p+"px no-repeat;";r+="background-size:"+v+"px "+x+"px;";return'<img src="'+A+'" class="img" style="'+r+'" alt="'+Config.htmlEntities(s)+'">'};var j=function(p){return p.replace(Config.rx_colons,function(q){var r;r=Config.mapcolon[q];if(r){return r}else{return""}})};c.memo("button.emoji",function(){if(document.emojiButton===undefined){document.emojiButton="fa fa-smile-o fa-lg"}var p=k.button({tooltip:"表情",contents:'<i class="'+document.emojiButton+' emoji-picker-container emoji-picker"></i>',click:function(){if(document.emojiSource===undefined){document.emojiSource=""}if(document.emojiType===undefined){document.emojiType=""}var q=o.$panel.width();if(q>o.$panel.position().left){o.$panel.css({left:"0",top:"100%"})}o.$panel.show()}});o.emoji=p.render();return o.emoji});this.events={"summernote.init":function(p,q){b()}};this.initialize=function(){this.$panel=a('<div class="emoji-menu '+e+'">\n    <div class="emoji-items-wrap1">\n        <table class="emoji-menu-tabs">\n            <tbody>\n            <tr>\n                <td><a class="emoji-menu-tab icon-recent-selected"></a></td>\n                <td><a class="emoji-menu-tab icon-smile"></a></td>\n                <td><a class="emoji-menu-tab icon-flower"></a></td>\n                <td><a class="emoji-menu-tab icon-bell"></a></td>\n                <td><a class="emoji-menu-tab icon-car"></a></td>\n                <td><a class="emoji-menu-tab icon-grid"></a></td>\n            </tr>\n            </tbody>\n        </table>\n        <div class="emoji-items-wrap mobile_scrollable_wrap">\n            <div class="emoji-items"></div>\n        </div>\n    </div>\n</div>').hide();if(typeof this.emoji!=="undefined"){this.$panel.appendTo(this.emoji.parent());f();h(0)}};this.destroy=function(){this.$panel.remove();this.$panel=null}}})}));